**微积分基本定理**

在曲边梯形面积的概念已经得到了良好定义之后，开始推导这个。

用A(x)表示f(n)到f(x)围起来的曲边梯形的面积

然后考虑A的增量。设$a>n，f(a)\neq 0$取增量d，假设f在a~a+d之间单调递增

$$
S=f(a)d
$$
$$
S'=(f(a+d)-f(a))d 
$$
$$
C=A(a+d)-A(a)-S
$$
于是
$$
\lim\frac{S'}{S}=0
$$
而$C<S'$,所以
$$
\lim \frac{C}{S}=\lim\frac{A(a+d)-A(a)}{f(a)d}-1=0
$$
因此A在x=a处可导，且
$$
A'(a)=f(a)
$$


**定义曲边梯形面积**


用黎曼积分，小矩形的和去定义。


但是，必须证明小矩形逼近函数面积的误差是在减小的，而且是要多小有多小。

可是，误差区域也是曲边梯形，我们现在还没有完成对于曲边形状的面积的定义呢！也就无法完成对于误差区域的面积的定义。这成了先有鸡还是先有蛋的问题。

为了处理这个问题，我们要引入一个【公理】：曲边梯形的面积（无论它的定义是什么）必须小于包围它的矩形的面积。
这样一来，我们才能计算误差的范围。借助这个公理，我们来完成曲边梯形的面积的定义，并回头验证我们的定义和这个公理确实是不矛盾的。这样或许是解决这个套娃的一个思路？

然后来计算误差。这些误差矩形有多大，其实取决于函数割线的斜率有多大。


区间长度$D$,均匀分割成n段，$d=\frac{D}{n}$，每一段的曲边梯形误差为$C_i$，则：
$$
C_i\leq d^2k_i
$$
$k$是$包围它的矩形的$对角线斜率。设$K=\max_i k_i$，则K是一个关于n的确定的值，
$$
\sum C_i\leq \sum d^2K^2=\frac{D^2K(n)}{n}
$$

如果这个函数的性质是比较好的，也即$\lim_n K$是收敛的，那么


$$
\lim_{n\rightarrow +\infty}\frac{D^2K(n)}{n}=0
$$
也就证明了小矩形分割所定义的曲边梯形的面积误差趋于无穷小。

然后，验证这个定义和前面那个公理不矛盾：

由于小矩形的面积和始终小于包围整个大曲边梯形的矩形的面积和，所以它的极限（如果存在），也小于这个矩形的和
也即，它能够导出前面的公理。


一段话总结思路：
        要定义曲边梯形面积→用小矩形逼近→要证明误差无限小→发现误差也是曲边梯形的面积，产生了循环。→为解决这个问题，引入一个公理条件Q：即如果我们能成功定义出来曲边梯形的面积，它必须比能包裹它的那个矩形要小，→加入条件Q后，发现在条件Q下，这个误差无限小（M）的证明是成立的→而且这个我们猜想它满足的前提也是成立的，因为在任何情况下小矩形逼近的面积都小于包含了曲边梯形的那个矩形的面积→说明我们的定义自洽。
        所以，如果我们把Q作为公理，我们可以推出M。
        但是M也能推出Q。
        所以Q和M等价。可任选其一作为公理。
        


---

**发散思维**

1.
上面那个构造里，如果K不收敛，怎么办？
的确可以找到这样的例子，比如$\sin (1/x)$
越靠近0，那么肯定会存在任意大的斜率，此时不能保证积分收敛
又比如，对圆做积分，就不能包含两边的点，也不能证明它一定收敛
（但是可以把一个小区域切分出去，剩下的部分可保证收敛，然后再取一次极限。）




2.
这个方法虽然算不出一个具体的实数出来，但我们是以几何为出发点，既然矩形的覆盖符合我们对于曲边梯形面积的视觉直觉，而且也证明了误差能要多小有多少，那我们也表示满意。


        解释2：即便不归结于切线斜率，也可以本着一种实用的精神，认为实际生产生活中使用到的函数的割线斜率总是有最大值的（否则那种函数的现实意义该多么古怪呢？）


        解释3：我们在求一个函数的积分前，都把【割线斜率有限】作为一个前提，不符合这个条件的函数，就不求积分。
        不管曲线的斜率是开区间还是闭区间，都取K为一个它到达不了的值，比如100万，那么误差仍然是趋向于0的。这里唯一存在的问题就是，我们的误差也是曲边梯形，但我们在完成对它的定义之前已经开始使用它了。

对于解释3，容易证明：如果f,g都在区间上割线斜率有限，那么以下函数在它们区间的交集上割线斜率有限：
$$
-f,\frac{1}{f},f+g,fg
$$
再根据$y=x,y=C,y=\sin x,y=a^x$割线斜率有限，容易得出：初等函数都是可以求积分的。

---

总结：由于面积包含了平方运算，因此面积误差是区间长度的二阶无穷小，对每个二阶无穷小进行一阶的无穷求和后，得到的仍然是一阶无穷小，再取极限就归为零了。

在上面的定义中我们没有讨论这是针对什么函数曲线进行的。不过我们不需要对所有函数都定义积分，那是一件挑战想象力的事。因为有很多奇形怪状的函数，我们现在限于实用性，不关心它们的所谓面积是什么。

所以，完全可以只把它当作是对由**有限个单调的区间组成，定义域在有理数上的，初等表达式写成的函数**。这样的函数看起来似乎就和我们分析过程中的函数是一致的。

---
**曲线求长**

上述思路推广到曲线求长

3、长度的定义。这里的长度可能是指曲线展开以后的长度，但在现实生活中这会涉及到材料的物理特性。没人知道一段曲线在展开后应该是多长，这压根不是数学问题。数学只是关心用小线段去逼近一个曲线的长度时，它能不能最终收敛，能收敛，这在数学上就让人满意了。基于这个前提，
定义$f$曲线长是

$$
l=\lim_d \sum_i \sqrt{1+k^2}d...*

\\
其中k是关于i，d的函数，不如记为\lim_d\sum_i k(i,d)d

$$

怎么求？能不能用子区间左端点的导数来近似？（假设处处可导）
$$
\lim \sum \sqrt{1+f'(id)^2}d

$$

那这两个积分的误差呢？
这是一个超级绕的问题。下面开始烧CPU了：

在每个子区间i上，
$$\lim_d k(i,d)=f'(id)
$$

lim符号外提，
$$
\lim_d \sum_i^{g(d)} \lim_{d'}(\sqrt{1+k(i,d')^2})d**
\\
显然\lim_d (\sqrt{1+k(i,d)^2})收敛，把这个式子写成\lim_d K(i,d)=A(i)

$$

我们就是想问，如果这个式子收敛，那么它能和*等价吗？


我们直接深入底层、用定义法。声称这个式子收敛，就是在说：
$$
存在A_i，任给e,存在r使得只要d<r(e,i),则|K(i,d)-A(i)|<e\\
任给e'，存在r'使得只要d<r'(e')，则|ΣA(i)d-B|<e'
$$


那么，如果我们想凑出一个放缩，可以考虑这么做：

任给E，先取一个d使得
$$
d<r'(E/2)
$$

再继续缩小它使得


$$
d<r(E/2D,i),i=1,2,...
$$

---
p.s
上面这个条件也即：每个子区间上的割线斜率与导数的误差都要小于一个常数，并且此时r不依赖于d。这是由于，我们实现这个条件的过程要缩小d，而缩小d的过程中可能会产生新的子区间，为了保证这些新产生的子区间上的割线斜率误差与导数误差足够小，又得继续缩小d，于是又可能产生新的子区间...一直循环下去，我们就不知道这样的d是否能存在了。所以需要做一个约束：那就是函数r和x没有关系。

换而言之，这等价于：

$$

任给e，都存在D(e)，满足只要d<D，则 (f(x+d)-f(x)/d)=f'(x)
\\
【它要求D跟x具体是多少无关】。这个条件叫做【一致收敛】。
\\
举个例子，(x^2)'=2x,那么\frac{(x+d)^2-x^2}{d}=2x+d
\\
它与导函数的差为d，要使得它小于e，只要使得d<e，和x无关。

$$

---

回到推导。那么此时就会有
$$

|\sum_i^{g(d)} K(i,d)d-B|=|\sum((K(i,d)-A(i))d+\sum A(i))d-B|
\\<E/2+E/2=E
$$
得证。




4、另一个现实解释比如车轮走过的轨迹。这个曲线长是有意义的。


5、不考虑现实意义，可以直接定义曲线长为无穷多个线段累加的长度（因为它符合视觉上的直觉）。以【割线斜率存在上界】为前提，仍然可以证明曲线长存在上界。以此，可以定义圆弧的长度。

积分中值：
f单调，且它的值域填满Q。
那么曲边梯形面积，出于一种几何直觉：
$$
S(a,b)-f(\xi)(b-a)可以任意小。 \xi \in(a,b)
$$