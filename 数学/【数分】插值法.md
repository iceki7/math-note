假设有一个n次多项式f经过了若干个点，我们现在想把一个新的点加进去，问：

g=Axf+Bx+C能不能插入这个新的点。

假设f(a)=a'，现在要插入(b,b'),f(b)=q

那么求线性方程组：

Aaa'+Ba+C=a'
Abq+Bb+C=b'

$$
\begin{bmatrix}
    aa' & a & 1
    \\ bq & b & 1
\end{bmatrix}
\begin{bmatrix}
    A \\B \\ C
\end{bmatrix}=
\begin{bmatrix}
    a' \\b'
\end{bmatrix}
$$

首先，a!=b，不失一般性，可以假设a=0,a'=0
这是因为如果a在原点，b无论在哪都可以完成嵌入。
那么就算a不在原点。我们也可以将f、b一起平移到a在原点并得到曲线f',点b'，在嵌入了b'的函数g'反向平移回去即可。
所以C=0，Abq+Bb=b'，令A=1，由于b!=0，所以B=b'/b-q

即新的曲线为$g=xf+(b'/b-f(b))x$

然后考虑aa'!=0的情况。此时要平移f，插入后再平移回去，所以

$g'=xf'+((b'-a')/(b-a)-f'(b-a
))x$


$g=(x-a)f+(k_{ab}-f(b))(x-a)+a'$


---

由于k次曲线过给定k+1个点大多数情况只有一条（线性方程组），现在有若干个点需要插值，只需要从直线开始构造即可得到过所有点的方程式。（其实这个过程等效于解线性方程组，范德蒙行列式）Vx=b

---

数据转换：如果等距采样，点个数是N，原本的N个值就可以被编码为方程的N个系数。约定起始点和采样步长即可。


---

f通过n个点，构造一条n+1次曲线g，通过前面的点以及一个指定的新的点。
我们希望g和f是有关系的，最好是能由f写出g的表达式，而不是需要重新解线性方程组。
也就是说，g是f的四则运算，形如g=Axf+Bf+C的形式，我们不希望添加更多的x^i项。

先考虑最简单的情况：g比f高一次，且通过f上的某一点，怎么构造g？
经过观察，可以注意到：
g=Ax(f-a')+a' 这高1次，且通过f上的指定一点。但是它不能再强制通过另外一点。
怎么改造这个式子?既然至少有2个点，我们将它们的直线方程L塞进g里：
g=A(x-a)(x-b)+L.这种情况对于f是一次时是可行的。即f=L。
现在要求通过g上新多出来的一点c。
那么A(c-a)(c-b)+f(c)=c' A=(c'-f(c))/(c-a)(c-b)

如果L不是直线，而是一个二次函数？似乎还是可行：
h=B(x-a)(x-b)(x-c)+g

B=d'-g(d)/(d-a)(d-b)(d-c)

所以插值曲线为：
$$
l'(x)=\frac{y'-l(x')}{\prod_i(x'-x_i)}\prod_j(x-x_j)+l(x)
$$

其实稍微想想，l'(x)不一定非得是多项式
如果l(x)经过了若干个点，想用三角函数插值呢？
$$
l'(x)=\frac{y'-l(x')}{\prod_i(\sin(x')-\sin(x_i))}\prod_j(\sin(x)-\sin(x_j))+l(x)
$$
这是因为三角函数的乘积仍然是三角函数。

还可以换一种方式：只要保证连乘号右边为0即可：
$$
l'(x)=\frac{y'-l(x')}{\prod_i\sin(x'-x)}\prod_j(\sin(x-x_j))+l(x)
$$
一般地，
$$
l'(x)=\frac{y'-l(x')}{\prod_if(x')-f(x_i)}\prod_j(f(x)-f(x_j))+l(x)
$$
我们甚至可以在每一阶使用不一样的函数。或者在连乘的时候乘多种函数。

例如可以用它估计圆。
在0~1区间内，项越高阶，它的影响越小，用来控制细节。
在0~1区间外相反。
越靠近0，高阶项的影响越小。

（定义积分可以直接任意给面积赋一个数字，只要符合公理Q即可）

所以估计圆的时候可以省略高阶项。
一个要穿过4个点的三次曲线要拐2次弯，如果用它拟合一个单调区间，但这两个弯出现在这个区间里就麻烦了。

等距离插值，假设从x=0开始，在0~D上插值,n>=2。
$$
l^n(x)=\frac{y_n-l^{n-1}(x_n)}{d2d..(nd)}\prod_j^n(x-jd)+l^{n-1}(x)
\\=\frac{y_n-l^{n-1}(x_n)}{n!d^n}\sum_{i=0}^nx^i(-d)^{n-i}m_{n-i}+l^{n-1}(x)
\\ l^1(x)=\frac{y_1-y_0}{d}(x-d)+y_1
\\ l^2(x)=\frac{y_2-(y_1-y_0)-y_1}{2d^2}(x-d)(x-2d)+l^1(x)
\\我们把它写成差分的形式\Delta_{0,1}
\\ 
\\=\frac{\Delta_{12}-\Delta_{01}}{2d^2}(x-d)(x-2d)+\frac{\Delta_{0,1}}{d}(x-d)+y_1

\\=(x-d)(\frac{\Delta^2_{0,1,2}}{2d^2}(x)+\frac{2\Delta_{0,1}-\Delta_{12}}{d}+y_1
\\猜想l^n=\Delta^n/n!d^n\prod(x-jd)
\\假设n=k时，结论成立，
$$

而
$$

y_{k+1}-l^k(x_{k+1})=\Delta^k_{0,1,...k}k!d^k/k!d^k+l^{k-1}(x_{k+1})


$$
这里就得到了牛顿插值法的公式，它是泰勒级数的离散对应。

就像差分是微分的离散对应一样。
