我们想用数格子的方式来逼近派

所以 要计算出圆内的格点的数目

为此 首先考虑格点什么时候会落在圆上，然后从小到大扩大圆的半径，累加落在圆上的格点数目，就数出了圆内的格点数

为了让每个格点都落在一个圆上，我们只考虑半径为
$\sqrt{n}(n\in N)$的圆

即给出$n$，求满足$a^2+b^2=n$的整数对的个数。

在复平面上，平方和被转换为乘积$n=z\bar{z}$，也就是问能找到多少个复共轭对z。

对整数n做因子分解后，将素因子$d$分解为高斯整数
$$
d=z\bar{z}
$$
注意$z,-z,iz,-iz$只能算1对

（只考虑1/8圆周内的点才不会重复）

---
费马平方和定理

奇素数p可以表示为两个正整数的平方和，当且仅当

$$
p\equiv 1 \mod 4
$$

---

由于
$$a,b\equiv 3\mod 4\Rightarrow ab\equiv 1\mod 4$$



可以构造出一个积性函数$\chi(xy)=\chi(x)\chi(y)$：
$$
\chi(a)=1  ,a\equiv 1 \mod 4    \\
\chi(a)=-1  ,a\equiv 3 \mod 4   \\
\chi(a)=0  ,2|a 
$$

对n，在高斯整数上分解以后，尝试使用$\chi$写出它的分解种类的个数。
例如：$n=2^23^45^3$
$$
格点数
f(n)=4(\chi(1)+\chi(2^1)+\chi(2^2))\cdot \\
(\chi(1)+\chi(3^1)+...\chi(3^4))\cdot \\
(\chi(1)+...+\chi(5^3))\\
$$

以3为例，为了形成共轭对只能两边分配同样多个。所以它要么由于不能分配成功，N没有共轭分解，要么就只有一种分解。5同理，假设5=$z\bar{z}$，那么它的分配方式有$1,z,z^2,z^3$三种，对于2，它不影响结果。

将$f(n)$展开，根据积性函数，它包含了n的所有因子。
即
$$f(n)=4\sum_{d|n}\chi(d)
$$
然后计算半径R的圆的近似面积S(R)：
$$
S(R)=\sum_{n=1}^{R^2} f(n)
$$
由于$[1,R^2]$里有约$\frac{1}{n}$的数是n的因子，所以
$$
S(R)\approx 4 \sum_{i=1}^{R^2} \frac{R^2}{i}\chi(i)\\
\pi \approx 4(\frac{1}{1}-\frac{1}{3}+\frac{1}{5}-...)
$$