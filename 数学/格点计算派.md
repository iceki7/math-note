我们想用数格子的方式来逼近派

所以 要计算出圆内的格点的数目

为此 首先考虑格点什么时候会落在圆上，然后从小到大扩大圆的半径，累加落在圆上的格点数目，就数出了圆内的格点数

为了让每个格点都落在一个圆上，我们只考虑半径为
$$r=\sqrt{n}(n\in N)$$
的圆

即给出$n$，求满足$a^2+b^2=n$的整数对的个数$f(n)$

在复平面上，平方和被转换为乘积$n=z\bar{z}$，也就是问有多少个共轭对

思路：对整数n做因子分解后，将素因子$d$分解为高斯整数
$$
d=z\bar{z}
$$
注意$z,-z,iz,-iz$只能算1对

（只考虑1/4圆周内的点才不会重复）


---
费马平方和定理

奇素数p可以表示为两个正整数的平方和，当且仅当

$$
p\equiv 1 \mod 4
$$

这给了我们启发，将$d$进行分类讨论。

---
高斯整环的分解
将整数分解为高斯整数d=z_1z_2...
要注意由于i，-i,1,-1总可以做除数，所以它们实际上不会再被分解。

---

由于
$$a,b\equiv 3\mod 4\Rightarrow ab\equiv 1\mod 4$$



可以构造出一个积性函数满足$\chi(xy)=\chi(x)\chi(y)$，也即$\chi(x^n)=\chi^n(x)$
$$
\chi(a)=1  ,a\equiv 1 \mod 4    \\
\chi(a)=-1  ,a\equiv 3 \mod 4   \\
\chi(a)=0  ,2|a 
$$
这个函数一方面，它输入一个数字，返回它mod 4时的情况；另一方面，它可用来计数：


它和莫比乌斯函数有点像.


对n，在高斯整数上分解以后，尝试使用$\chi$写出它的分解种类的个数。


---


例如：$n=2^23^45^3$，求$f(n)$
$$

f(n)=4(\chi(1)+\chi(2^1)+\chi(2^2))\cdot \\
(\chi(1)+\chi(3^1)+...\chi(3^4))\cdot \\
(\chi(1)+...+\chi(5^3))\\
$$

以3为例，3是高斯素数。根据算术基本定理，$3^n$在$\mathbb{C}$上只能分解为$3^i3^{n-i}$，如果要n最后能被分解为共轭的两个数$z,\bar{z}$，那么这两个数中3因子的个数肯定是一样多的。所以分解方式只有$3^{4/2},3^{4/2}$，这经由 $f(n)$第二项表示了出来。

以5为例，5不是高斯素数，所以$5^3=z^3\bar{z}^3$，那么它的分解方式有$\bar{z},z\bar{z}^2,z^2\bar{z},z^3$三种，

2的素数分解是：$2=(1+i)^2(-i)$，只有一种分配方式

将$f(n)$展开，根据积性函数，它包含了n的所有因子。
即
$$f(n)=4\sum_{d|n}\chi(d)
$$
然后计算半径R的圆的近似面积S：
$$
S=\sum_{n=1}^{R^2} f(n)
$$
由于$[1,R^2]$里有约$\frac{1}{n}$的数是n的因子，所以
$$
S(R)\approx 4 \sum_{i=1}^{R^2} \frac{R^2}{i}\chi(i)\\
\pi \approx 4(\frac{1}{1}-\frac{1}{3}+\frac{1}{5}-...)
$$