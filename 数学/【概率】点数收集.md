收集1个骰子上的所有点数需要几次

---

**直接计数**

扔n次，所有可能情况$6^n种$，去掉里面花色<=5种的情况$C_6^5 5^n种$，但是删多了，因为把花色<=4种的也删掉了，所以补回来$C_6^4 4^n$，类推

---
一开始没想到上述公式。绕了一个大弯：


k个点数,假设恰好是在第n次时集齐的概率是:

$$
p_k(n)=\frac{kx(n-1,k-1)}{k^n}
$$
x表示一个包含了k-1种点数的长为n-1的串的个数,但是想不出来是多少.



再考虑扔出n次之后,集齐了的概率是:

$$
\sum_{i=k}^n p_k(i)=q_k(n)
\\=\frac{x'}{k^n}
$$

x'是一个包含了k种点数的长为n的串的个数(注意，k种指的是总共只有k种点数，凑齐一个n长的串，而不是指从若干花色里选k种然后再凑齐这么一个串,那样的话有3个自由度了)

所以$x'=x(n,k)$

注意到，如果选k个时集齐了花色，要么就是在第k个时集齐的，要么就是在第k-1个时就已经集齐了，形式化地描述就是：
$$
x(n,k)=x(n-1,k)k+x(n-1,k-1)k
$$

先写一些观察一下:

$x(1,i)=1,i\in[1,n]\\
x(2,i)=1,2,\\
x(3,i)=1,6,6,\\
x(4,i)=1,14,36,24,\\
x(5,i)=1,30,150,240,...\\
x(6,i)=1,62,540,1560...
$



而$x(n,2)=2^n-2,x(n,1)=1$


$$
x(n,3)=3x(n-1,3)+2^{n-1}\cdot3-6

\\设x(n,3)+2^na+C=3(x(n-1,3)+2^{n-1}a+C)
\\\Rightarrow a=3,C=-3
\\所以x(n,3)+2^n\cdot 3-3是等比数列，首项27，
\\x(n,3)=3^{n}+3-3\cdot 2^n
$$

之后怎么办呢？思路1是猜测x(n,k)的表达式是形如
$$
Ck^n+C'(k-1)^n+C''的形式
$$
然后用归纳法验证。有一定运气成分。这个条件可能不够强。


思路2是回到x(n,3)的语义上来。它的表达式看起来并不复杂，是不是提示了一种之前没想到的计数的方式？

还是很难看出来

于是再算一组：
$$
x(n,4)=4^{n}-4+6\cdot 2^n-4\cdot 3^n
$$

仍然无果。那就上函数空间的线性变换吧。
基就是$k^n$，把x写为系数向量，比如
$x(n,4)=[-4,6,-4,1]^T$
那么递推关系式就是：
$$
x_k=k\begin{bmatrix}
  1  & 0 & 0 & 0\\
  0  & 1/2 & 0 & 0\\
    0  & 0 & 1/3 & 0\\
      0  & 0 & 0 & 1/4\\
\end{bmatrix}(x_k+x_{k-1})=K(x_k+x_{k-1})
\\


(I-K)x_k=Kx_{k-1}
\\=x_{k-1}-Kx_{k-2}=x_{k-1}-x_{k-2}+Kx_{k-3}
\\=x_{k-1}-x_{k-2}+x_{k-3}-x_{k-4}+...+(-)Kx_1
\\\\
x_1=[1]\\
x_2=[-2,1]\\
x_3=[3,-3,1]\\
x_4=[-4,6,-4,1]\\
x_5=[5,-10,10,-5,1]\\
x_6=[-6,15,-20,15,-6,1]\\
(I-K)x_3=x_2-Kx_1
\\
观察系数，如果在x的第一项前面再扩展一项1，\\则猜想方程的解就是(*表示扩展出来的区域):
\\

x_n=\begin{bmatrix}
 1* & -1*  & 0* & 0* & 0*\\
 0*& 1  & -1 & 0 & 0\\
 0*&   0  & 1 & -1 & 0\\
 0*&     0  & 0 & 1 & -1\\
\end{bmatrix}x_{n-1}


$$


$$
q_6(n)=\frac{-6+15\cdot 2^n-20\cdot 3^n+15\cdot 4^n-6\cdot 5^n+6^n}{6^n}
$$
