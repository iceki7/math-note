收集1个骰子上的所有点数需要几次

k个点数,假设恰好是在第n次时集齐的概率是:

$$
p_k(n)=\frac{kx(n-1,k-1)}{k^n}
$$
x表示一个包含了k-1种点数的长为n-1的串的个数,但是想不出来是多少.



再考虑扔出n次之后,集齐了的概率是:

$$
\sum_{i=k}^n p_k(i)=q_k(n)
\\=\frac{x'}{k^n}
$$

x'是一个包含了k种点数的长为n的串的个数(注意，k种指的是总共只有k种点数，凑齐一个n长的串，而不是指从若干花色里选k种然后再凑齐这么一个串,那样的话有3个自由度了)

所以$x'=x(n,k)$

注意到，如果选k个时集齐了花色，要么就是在第k个时集齐的，要么就是在第k-1个时就已经集齐了，形式化地描述就是：
$$
x(n,k)=x(n-1,k)k+x(n-1,k-1)k
$$

先写一些观察一下:

$x(1,i)=1,i\in[1,n]\\
x(2,i)=1,2,\\
x(3,i)=1,6,6,\\
x(4,i)=1,14,36,24,\\
x(5,i)=1,30,150,240,...\\
x(6,i)=1,62,540,1560...
$



而$x(n,2)=2^n-2,x(n,1)=1$


$$
x(n,3)=3x(n-1,3)+2^{n-1}\cdot3-6

\\设x(n,3)+2^na+C=3(x(n-1,3)+2^{n-1}a+C)
\\\Rightarrow a=3,C=-3
\\所以x(n,3)+2^n\cdot 3-3是等比数列，首项27，
\\x(n,3)=3^{n}+3-3\cdot 2^n
$$

之后怎么办呢？思路1是猜测x(n,k)的表达式是形如
$$
Ck^n+C'(k-1)^n+C''的形式
$$
然后用归纳法验证。有一定运气成分。这个条件可能不够强。


思路2是回到x(n,3)的语义上来。它的表达式看起来并不复杂，是不是提示了一种之前没想到的计数的方式？

还是很难看出来

于是再算一组：
$$
x(n,4)=4^{n}-4+6\cdot 2^n-4\cdot 3^n
$$

仍然无果。那就上函数空间的线性变换吧。
基就是$k^n$，把x写为系数向量，比如
$x(n,4)=[-4,6,-4,1]^T$
那么递推关系式就是：
$$
x_k=k\begin{bmatrix}
  0  & 1 & 0 & 0\\
  0  & 0 & 1 & 0\\
    0  & 0 & 0 & 1\\
      0  & 0 & 0 & 0\\
\end{bmatrix}(x_k+x_{k-1})=K(x_k+x_{k-1})
\\
x_k=Kx_{k-1}(I-K)^{-1}
\\x_k=K^kx_1((I-K)^{-1})^k
$$

