为啥非得要把素数分解成两个数的平方和？研究这个问题可能刚开始让人觉得莫名其妙 有什么必要去证明它能或者不能吗？

所以我们先换个视角，去研究一个素数在复整数域$\mathbb{Z}+i\mathbb{Z}$下能不能被分解 如果它能，它不就“不素”了吗？这个问题似乎听起来稍微有价值一些


然后开始思考 两个复整数$a+bi,c+di$如果乘起来是个整数需要满足什么条件？发现

$$d=\frac{bc}{-a},d|bc$$

显然d和bc不能都互质。

如果$(b,d)=1$，那么$d|c$，$c+di$可以提出一个因子，如果是这种情况，所研究的整数就不是素数了


所以如果要求素数能被分解，则$(c,d)=1$，设
同理可知$(a,b)=1$ 设$b=dm,c=an$

则形式变为$(a+dmi)(an+di)$

一个简单的情况是$m=-1,n=1$ 此时平方和的形式就出现了。


然后我们看下如果能表示成平方和，素数需要有什么性质。把它放在模4集合里考虑，会发现平方运算只会得到4k和4k+1的元素。所以p是4k+1的。（其实能表示成平方和的奇数都是4k+1的，不管是不是素数）

那么平方和定理的必要性就推完了。
充分性则是一个大工程了。有很多种推法，有些取巧，但是思路不那么直观。

其实在预先得知这个定理之前，连这个东西是成立的恐怕都是件很不自然的事吧？既然如此，问题可能还不仅在于如何证明，而在于为什么会做出这种猜测。可能是前人得到必要性条件后，试了几组发现都成立，所以做出的猜测吧。



---
**充分性**

跟着欧拉的思路。研究能表示成平方和的整数的集合$S$的性质。

首先，S对乘法封闭。这个很容易证，略过。




---
**old**
由wilson定理，p=4n+1时，
$$
(p-1)!\equiv -1 \\
\equiv(2n)!(2n+1)...(4n) \\
\equiv(2n)!(-2n)(-2n+1)...(-1) \\
\equiv ((2n)!)^2=s^2\mod p
$$
即
$$
p=4n+1\Rightarrow p|s^2+1(*)
$$
这个形式在之前证明wilson定理的时候见过，不过当时出现的是平方差，这里是平方和。
$$
(*)\Leftrightarrow p|(s+i)(s-i)
$$
如果p是高斯素数，

那么s+i,s-i至少有一个与p（高斯整数意义下）互质，即p|s+i，或p|s-i，这是不可能的？？？？

所以p=4n+1不是高斯素数。假设它可以分解为：$mn=p,且m,n\neq 1,-1,i,-i$

那么$|p|^2=|m|^2|n|^2$，
显然$|m|^2\neq 1,p^2$，所以$p=|m|^2=|n|^2$，得证



---

右推左 -2

设能表示为平方数之和的整数的集合为$\mathbb{S}$


设
$$
x=a+bi,y=q+pi\\|x|^2=s,|y|^2=s'\\s,s'\in \mathbb{S},s'\in \mathbb{P}
$$
设$xy$的实部、虚部分别为$R、I$,$x(i\bar{y})$的实部虚部分别为$R',I'$。

**引理1**
$$
若a=\frac{s}{s'}，,则a\in \mathbb{S}
$$
$$
-RI'=p^2(a^2+b^2)-a^2(q^2+p^2)=\\
p^2|x|^2-a^2|y|^2
$$



所以$|y|^2|RI'$

若$|y|^2|R$，而$|x|^2|y|^2=|xy|^2=R^2+I^2$

所以
$$
|y|^2|I^2，a=\frac{R^2}{|y|^2}+\frac{I^2}{|y|^2}
$$
若$|y|^2|I'$，由于$|x|^2|y|^2=|x(i\bar{y})|^2=R'^2+I'^2$
所以
$$
a=\frac{R'^2}{|y|^2}+\frac{I'^2}{|y|^2}
$$

**引理2**

$$
若am=s, m\notin  \mathbb{S},
则\exists n\notin  \mathbb{S},n|a


$$
将a做素因子分解，然后将$s$依次除掉每个素因子，会发现剩余部分都在S中，如果除到只剩一个因子$p$了还是如此，那么除掉p后表明m在s中，矛盾。

**引理3(无穷递降法)**
$$
(a,b)=1,v|s\Rightarrow,v\in \mathbb{S}
$$
设$a=mv\pm c,b=nv\pm d,|c|,|d|\leq v/2$

即把a,b表示为数轴上最靠近x分度的那个数

$s=Av+c^2+d^2\Rightarrow v|c^2+d^2,设uv=(c^2+d^2)$

i.
$$
(c,d)=\zeta\neq 1$$
假设 $(\zeta,v)=\xi\neq1$，则$\xi|a,b$，矛盾

所以$(\zeta,v)=1 , \zeta^2|u\\
\exists z\leq x/2,e^2+f^2=zx\in \mathbb{S}，(e,f)=1
$
如果c,d互质，直接使用c,d而非e和f

如果
$v \notin S,根据引理2，\exists w|z,w\notin S$
矛盾

所以$v\in S$

最后的证明：

$$
p=4n+1,(k)^{4n}\equiv 1 \mod p,1\leq k\leq 4n \\
由于(k^{4n}-j^{4n})=(k^{2n}+j^{2n})(k^{2n}-j^{2n})
\equiv 0
$$
假设任给$k,{(k+1)}^{2n}\equiv{k}^{2n}$,这与$(2n)!\neq 0\mod p$矛盾

所以假设不成立。

所以至少有一个k，使得$p|(k^{2n}+(k+1)^{2n}),1\leq k\leq 4n-1$

由引理4，$p\in S$

由于$\exists z,|z|\neq 1,p=z\bar{z}$，所以$p\equiv 1\mod 4$不是高斯素数。

---
如果p=4n+3不是高斯素数，
假设p=ab，那么
$$
p=|a|^2=|b|^2
$$
它与平方和定理（即上文中的左推右部分）矛盾。
所以：

*奇素数是高斯素数，当且仅当$p\equiv 3\mod 4$*


---
**高斯整环**

1，-1，i,-i总可以做除数；

高斯素数：除了上述的数以外不能被其他元素整除的元素

上面已经讨论了奇素数是不是高斯素数。下面讨论其他的

$2=(1+i)^2(-i)$，2不是；

对$n=a+bi,ab\neq 0$，假设
$$
|n|^2=|x|^2|y|^2
$$
如果$|n|^2\in \mathbb{P}$，那么$|x|^2=1$，n是高斯素数


如果$|n|^2\notin \mathbb{P}$，假设它有一个素数因子p，则$p|n\bar{n}$


一 如果p,n有（高斯整数意义下的）公因子d，那么

I. 4|p-3，那么$d=p,p|n$，此时n不是高斯素数

II. 4|p-1,
    i.如果p|a且p|b，那么n不是高斯素数；
    ii.反之，则!p|n，

二 如果p,n（没有高斯整数意义下的）公因子，
假设n=c+di，


I. (c,d)=k,≠1，则n=k(c'+d'i),n不是高斯素数。

II.(c,d)=1，则如果n不是高斯素数，要求：
(x+yi)(z+wi)=c+di，即：xz-yw=c,xw+yz=d（A）
xy!=0,zw!=0
s(xz-yw)+t(xw+yz)=1 (B)
此时p,c+di没有公因子 (C)
而且p|(x2+y2)(z2+w2) (D)

根据D，不妨假设p|(x2+y2)，


所以n不是高斯素数。

例如，假设n=3+7i
那么$|n|^2=58$,$p=29$，
前面的定理声称29和3+7i有公因子。

29=(2+5i)(2-5i)，而(3+7i)/(2-5i)=(-1+i)，成立。

