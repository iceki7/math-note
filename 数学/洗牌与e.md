**问：将一副有顺序的扑克牌（54张）洗乱，问任何一张牌都不在自己的初始位置上的概率是多少？**


设n个元素的全排列中，有k个元素就在自己原本位置上的排列个数为s(n,k)。

那么会有如下一些容易得到的性质：

1.$\sum_{i}s(n,i)=n!$

2.$s(n,k)=s(n-k,0)\cdot C_n^k$


为方便，设$s(0,0)=1$。

为了得出通项公式，先观察s(n,0)的规律：
0,1,2,9,44,265,......

由上面的规律，猜测：
$$
s(n,0)=s(n-1,0)\cdot n+(-1)^n\quad n\geq 1
$$
将$s(n-1,0)$继续展开，可以得到通项公式：
$$
s(n,0)=s(1,0)n!+
(-1)^2\frac{n!}{2!}+
(-1)^3\frac{n!}{3!}+
...+
(-1)^n=\sum_{i=2}^n(-1)^i\frac{n!}{i!}\quad n\geq 2
$$
下面证明它的正确性。

首先，n=2时该通项公式成立。

假设$2\leq n\leq k$时公式成立，那么n=k+1时，由条件1、2可知：
$$
s(k+1,0)=(k+1)!-s(k+1,1)-...-s(k+1,k+1)
\\-
\\=(k+1)!-s(k,0)C_{k+1}^1-s(k-1,0)C_{k+1}^2-...-s(0,0)C_{k+1}^{k+1}
\\-
\\=(k+1)!-\sum_{t=0}^kC_{k+1}^ts(t,0) \quad (*)
$$


如果要证明n=k+1时通项公式也成立，等价于证明:
$$
(k+1)!=\sum_{t=2}^{k+1}C_{k+1}^ts(t,0)+1
$$
化简：
$$
1=\frac{1}{(k+1)!}+\sum_{t=2}^{k+1}\frac{1}{(k+1-t)!}\sum_{i=2}^t\frac{(-1)^i}{i!}
$$

由于n=k时公式已经成立，只要对比n=k+1相对于n=k时右边的新增的项即可。

记$
p(t)=\sum_{i=2}^t\frac{(-1)^i}{i!}$,则原式等同于证明：
$$
\frac{1}{(1+k)!}-\frac{1}{k!}
+\sum_{t=2}^{k+1}\frac{1}{(k+1-t)!}p(t)-\sum_{t=2}^k\frac{1}{(k-t)!}p(t)=0
$$
化简后的样子：
$$
\\
\frac{1}{(1+k)!}-\frac{1}{k!}
+\sum_{m=2}^{k+1}(-1)^m\frac{1}{m!}\frac{1}{(k+1-m)!}=0
$$

即：
$$
\sum_{m=0}^{k+1}(-1)^m\frac{1}{m!}\frac{1}{(k+1-m)!}=0
\\-
\\
\sum_{m=0}^{k+1} C_{k+1}^m(-1)^m=(1+(-1))^{k+1}=0
$$

由此，上式得证。

至此，我们终于确定了当$n≥2$时，
$$
s(n,0)=n!\sum_{i=2}^n(-1)^i\frac{1}{i!}
$$

据此，洗牌问题的概率就是：
$$P=\frac{s(54,0)}{54!}\approx0.368$$

对比泰勒展开不难看出来，当牌的数目越多的时候，所求得得概率就会越接近$\frac{1}{e}$


牌越多 任何一张牌落在自己原来位置上的概率就会越小。可是牌的数量也在增多，这意味着允许试错的机会也在增加。这两个相互矛盾的因素的对抗，让最后的概率既没有趋近0，也没有趋近1。
类似地，计算复利时，计息周期越短，加息的次数也就越多，可是相应地，每次加息的比例也会越小，这两种因素的相互作用让最后的利率逼近一个极限