


**gradient**
$$
\nabla  p=
(
  p_x, p_y, p_z )

$$
显然，函数极值点处 $\nabla f=\vec{0}$，但反过来则不然，该点有可能是鞍点，因此还需要雅可比矩阵和海森矩阵用于判断。

**divergence**
$$
\nabla \cdot \bold{v}=u_x+v_y+w_z
$$

$$
\nabla \cdot (k\mathbb{I})=\nabla k
$$

**旋度**

向量场$\vec{F}(x,y,z)=(a,b,c)$
$$
\nabla \times (a,b,c)=\begin{vmatrix}
 \vec{i} & \vec{j} &\vec{k} \\ 
 \frac{\partial }{\partial x} &\frac{\partial }{\partial y} &\frac{\partial }{\partial z}
  \\ a&b&c \end{vmatrix}
$$
**Laplace operator**
$$
\nabla^2 f=\nabla\cdot (\nabla f)
$$
如果是标量，拉普拉斯运算后仍然是标量。

其他规则：
$$
\nabla (uv)=u\nabla v+v \nabla u \\
\nabla \cdot (\nabla \times \vec{F})=0
$$


---

如果变量不是解析的，而是一些统计量或者采样，还能不能求梯度呢？
当然我们知道对一个完全随机分布的数据，求出梯度也没有意义。

所以,1.不妨假设这里的数据虽然没有解析式，仍然可以认为是“平滑”的。相邻的数据点之间不是充满毛刺的突变，而是平顺的渐变，这也符合我们在生活中观察到的各类数据的特征，只有在这种情况下，梯度才有一定的意义可言。
问题是如何定义这种渐变。
从最简单的情况开始，假设在一个二维的标量场中，只有1个2×2的数据，从直觉来看，什么情况下我们会认为它是“平滑”的？
比如：
5 6
6 7
这个数据是平滑的。
5 6 
4 9
这个也可以认为是平滑的。
5 9
7 4
这个似乎不能认为是平滑的。7和9就像组成了一道山峰，挡住了5和4之间的去路。
从以上的例子中能不能尝试地定义一下什么叫平滑呢？
如果一个元素的两个相邻的元素都比它大，并且与这两个元素相邻的那个元素也比它大，那么称A是平滑的。

是时候写一个程序验证一下我们的这个指标能否判断出一个标量场中平滑和不平滑的量都有哪些了。

2.另一个思路是对数据进行插值得到解析式。


确定了平滑的定义后，似乎就能确定一个基于统计得来（而非解析的）场量的梯度了。
梯度的概念，就是要确定在x和y方向上各自移动几个格子，才能让值上升的最快。如果一次决策只走一个格子那么决定沿哪个方向走是很容易的。
但是这样效率太低，等价于暴力遍历整个解空间。
所以，如果一次要走出去很远，怎样保证让值不会落入局部最小呢？
最起码，这样行走似乎还是要对数据进行插值。
也就是仍然需要回到解析的方法里。
于是转换思路：如果是一个未知的空间（比如二维向量场），就在一个范围内等距采样，插值得到解析式，然后求解析式的梯度。（听起来怎么这么像神经网络？神经网络中，训练数据集不就相当于是用于拟合的样本点吗？模型则是插值得到的解析式，因为解析，所以可以求梯度，所以可以反向回传。

但这里还有所不同，NN中，沿着梯度运动一下的过程，就相当于调整了这个用于拟合的模型。但我们前面所构想的其实是一开始就找到一个最佳的插值，而不是拟合。并且沿着梯度方向运动的过程找到的最优解是问题的解。但是在NN中沿着梯度方向运动其实是调整这个拟合模型的过程，沿着梯度运动调整的其实是模型，而非解，是用模型来预测输入输出的有序对。）但不管怎样，似乎在一个高维空间中运动并寻找极值的过程，怎么着都得需要解析式。光是限定这个空间是“平滑的”，还是找不到

然后思考怎么插值吧。还是二维标量场。
可以考虑等间距采样。然后分别在两个方向上插值。
假设是3*3,就可以得到函数f1(x) f2x f3x
g1y g2y g3y  或者简写为h(x,y) 当然，h本身不是解析的。因为我们还没想办法让g1渐变为g2。
但是要求出一个点的梯度，或者说它在两个剖面上的斜率还是可以的。只要求f2' g2'即可

然后思考能不能把这些函数都整合到一个式子h中。
之所以要这样，是因为我们希望我们插值的效果应该是在整个区域上都是平滑的。

于是构思了一个插值的公式，比如，如果要把f1,g1插到一起，那么：
$$
h=(x-x_1)g_1(x)/(y_1-x_1)+f_1(y)(y-y_1)/(x_1-y_1)
$$
之后，如果要在h的基础上再插入一根曲线f2(y)，那么
$$
h'
$$

似乎不太好插。不如换个思路，我们不用插值了，不需要保证解析的函数一定通过采样的点，还可以用拟合。
用其他指标来衡量所设计的曲面和采样的近似程度。
比如逐点的相对MSE。我们希望这个曲面的表达式尽可能简单（因为那样方便求梯度）但同时又尽可能贴合采样


可以用神经网络随机表示一个高维的曲面，然后对这个曲面逐步进行调整。但即便不用NN，对于曲面的调整似乎也是一个迭代的过程，而不能一下就求出一个精确解

