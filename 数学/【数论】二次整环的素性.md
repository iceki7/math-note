**自然的思路比证明的简洁更重要**


从二次整环出发，证明平方和定理



$$
Z[\sqrt{D}]=a+b\sqrt{D}\\a,b\in Z
\\D=\pm1,\pm p
$$


---
**单位元**

例如$Z[i]$，如果定义等价关系，$z\sim iz\sim -z\sim -iz$，那么乘法单位元就是$(1,-1,i,-1)$

以下，将$Z[\sqrt{D}]$中的乘法单位元写为$\mathbf{1,0}$，

则：
$\mathbf{0}=0,\mathbf{1}=1$

元素不加说明都在$Z[\sqrt{D}]$中

使用共轭的概念，并且把数中含$\sqrt{D}$的部分记为实部$R$，另一部分记为虚部$I$。


---
**（乘法）可逆元**

x|1

---
**可约元**

m是可约元，是指如果
$\exists a,b, m=ab$,且$a,b$不可逆不为1.

---
V**零因子**
尝试去解，发现除非
$$
abcd\neq 0,ad=-bc,c^2=d^2D,显然无解
$$



---
$$
z|y \Rightarrow \bar{z} |\bar{y}
$$
如果$p$是素元，那么$\bar{p}$是素元。

$\bar{p}|ab\Rightarrow p|\bar{a}\bar{b}\Rightarrow p|\bar{a} \Rightarrow \bar{p}|a$


如果$z|1$，那么$\bar{z}|1$:

$\overline{zz^{-1}}=\bar{z}\overline{({z}^{-1})}=1，$，所以$\bar{z}|1,\bar{z}^{-1}=\overline{z^{-1}}$。


---

$a,b\in Z，在二次整环中a|b当且仅当在整数环中a|b$

---
V**素元**

定义：$p是素元，如果p|ab\rightarrow p|a或p|b$，规定p不为0且不可逆。

假设p可约，$p=ab|ab，→ab|a→a=abc,\\a(1-bc)=0,bc=1$，矛盾。

所以素元不可约(*)

---

V**可逆元的性质** 如果$z|1$

易证$(\bar{z})^{-1}=\overline{({z}^{-1})}$(*)
$$
若(R,I)\neq 1\Rightarrow (R,I)|z,z|1
$$
即$(R,I)|1$，这是不可能的

所以$(R,I)=1(*)$


$$
z^{-1}(z\bar{z})=\bar{z}
,所以z\bar{z}|R
$$ 
$$
同时，注意到i\bar{z}|1,所以z\bar{z}|I，即\bar{z}z=\pm 1(*)
$$


---

**素元和素数之间的关系**

$z$是素元，当且仅当$z\bar{z}$是一个素数$p$

证明（左推右）：
$z|z\bar{z}=p_1p_2...$

如果z是素元，那么存在$p=p_i,z|p$

则存在$n=p/z=x+y\sqrt{D}$
$$

xR+yID=p\\yR+xI=0 \\


$$
1.假设 x=0，→y!=0，R=0，yID=p，D=±1，yI=±p

2.假设 x!=0→R!=0，
$$
\Rightarrow
xz\bar{z}=pR,yz\bar{z}=-pI,x=\frac{pR}{z\bar{z}}=R/C,y=\frac{-pI}{z\bar{z}}=-I/C
$$
显然$x\neq 0\Rightarrow C|R,I$,否则x,y不是整数，$n$不存在，但我们知道n是必定存在的.

如果$C\neq \pm 1,这和(R,I)互质矛盾，所以p=\pm z\bar{z}$

---


**引理**：$a,b\in Z, (a,b)=1,z|a,z|b\Rightarrow z|1$


---
右推左：


$$z
\bar{z}=p,z|ab,a=a'+a''\sqrt{D},b=b'+b''\sqrt{D},证z|a或z|b
$$
若$(R,I)\neq 1，q|R,q|I,q^2|I^2,q^2|R^2,q^2|z\bar{z}=p$

所以$(R,I)=1$。

若$z|1,则\bar{z}=pz^{-1}，p|R,p|I，矛盾。$
所以$z$不可逆。

假设$p|I$,则$由于(R,I)=1，所以(p,R)=1$
 
但是：$z\bar{z}=R^2-(\frac{I}{p}p)^2D^2=p，p|R^2,p|R$，矛盾。

所以$(p,I)=1$

由欧拉定理，存在$I'\in Z,p|I'I-1,\\
z|I'z=I'R+I'I\sqrt{D},z|I'R+\sqrt{D}=-k+\sqrt{D}=m$



由于$z|-k+\sqrt{D}|D-k^2,z|p$，
所以
$p|D-k^2$，**D是$p$的二次剩余**

由于$R=\frac{z+\bar{z}}{2},I=\frac{(z-\bar{z})\sqrt{D}}{2D}$
构造一个式子：
$$
a'+a''k=\frac{a+\bar{a}}{2}\frac{m-\bar{m}}{2\sqrt{D}}-\frac{m+\bar{m}}{2}\frac{(a-\bar{a})\sqrt{D}}{2D}=\frac{m\bar{a}-\bar{m}a}{2\sqrt{D}}
$$
所以$u=(a'+a''k)(b'+b''k)=m(...)+\overline{mm}ab
$

所以$z|u$

如果$(u,p)=1,由于z|p，则z|1$，矛盾。

所以$p|u，即z|p|a'+a''k,或z|p|(b'+b''k)$

又$z|m$
所以$z|a,或z|b$？？？


$$
R=\frac{z+\bar{z}}{2},I=\frac{(z-\bar{z})\sqrt{D}}{2D}
\\
1\\
z|a'+a''k\Rightarrow z|a'I-a''R=\frac{a+\bar{a}}{2}\frac{(z-\bar{z})\sqrt{D}}{2D}-\frac{z+\bar{z}}{2}\frac{(a-\bar{a})\sqrt{D}}{2D}=(\bar{a}z-a\bar{z})\sqrt{D}/(2D)\\
z|I(\bar{a}z),z|\bar{a}z,z|R(\bar{a}z)
$$



---

**方程**


$p=z\bar{z}$,z未知。

如果它有解，根据上述定理，$z$是素元，且D是p的二次剩余。


如果它有解，且不止一个解，$z\bar{z}=c\bar{c},那么c可逆，h=zc^{-1}可逆$


$|h\overline{h}|=1，D<0时，它取1。$
所以它的解只有$h=\pm 1,c=\pm z$


【反过来，如果D是P的二次剩余】，则存在x,$p|x^2-D=c\bar{c}$

如果p是素元，假设p|c，这是不可能的，因为c的虚部是1。
所以p不是素元。
不妨加强一下条件，p如果不是素元的情况下它就必定可约：
此时，存在一个m不是素元，所以存在ab，m|ab，但m|a，m|b都不成立，且对于任意这样的m，m可以拆分成m=xy。它唯一因子分解？

（唯一因子分解，比如$D=-1$）*，那么$p=yy'|c\bar{c}$






---
**-1是P的二次剩余$\Leftrightarrow 4|p-1$**


r是p的原根，$p=4n+1,r^{(p-1)/2}\equiv -1是二次剩余$，由于