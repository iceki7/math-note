**encoder**

将样本x映射到$P(z|x)$，假设它是正态分布。

两个MLP分别预测$Z$的均值和方差。这两个量随x的不同而不同


从$P$中采样得到$z$，利用重参数技巧完成这一步以保证可导

$z$经过解码器还原为$X'$

---

**loss**

- x和x'的交叉熵；

- KL散度约束使得分布P(Z|x)靠近正态分布；

由于每个分布p(z|x)彼此有重合，所以decoder会被训练出对于噪声的健壮性，可用于生成介于两个样本之间相似的图片（区别于AE）。

---

VAE输出不是确定性的。
虽然用MLP预测出来的方差和均值是确定的
即训练完成后 每个输入x所对应的这两个量是唯一的
但是重参数过程得到的采样每次都不同。
除非把这个采样也记录下来。